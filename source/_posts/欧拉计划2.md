---
title: 欧拉计划2
date:  2017-3-7
tags: 算法,欧拉计划
category: 
---
Even Fibonacci numbers

> Each new term in the Fibonacci sequence is generated by adding the  previous two terms. By starting with 1 and 2, the first 10 terms will be:
>
> 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...
> 
> By considering the terms in the Fibonacci sequence whose values do not
> exceed four million, find the sum of the even-valued terms.

这题是求斐波那契数列不超过 4 百万的偶数的项之和。结果为4613732。
<!--more-->
## 循环求解
我们从斐波那契数列的第一项开始求解，如果是偶数则累加，当数值大于四百万时停止。关于斐波那契数列的求解和优化可以参考我前面的博客。　

```java
  
    public int sumOfEvenFibonacci(int n) {
        int result = 0;
        int temp = 0;
		int temp1 = 1;
    	int temp2 = 1;
        while (temp <= n) {
            temp = temp1 + temp2;
            temp1 = temp2;
            temp2 = temp;
            if ((temp & 1) == 0) result = result + temp;
        }
        return result;
    }
```

---

这里修正一下while (temp <= n) -->while (temp < n) ，虽然这里加上=号并不影响结果，但是这是一个意外，这是建立在斐波那契数列不会有连续两个偶数的基础上的。错误的在于边界情况的考虑。

---

## 改进
我们观察如下斐波那契数列：
1 1 **2** 3 5 **8** 13 21 **34** 55 89 **144** 233 377 **610** 987 1597 **2584** 4181

我们发现只有第3n项为偶数，我们可以思考一下偶数间的规律。我们知道f(n)=f(n-1)+f(n-2)
=2f(n-2)+f(n-3)
=3f(n-3)+2f(n-4)
=3f(n-3)+f(n-4)+f(n-5)+f(n-6)
=4f(n-3)+f(n-6)

换句话说，34=4\*8+2，144=4\*34+8。
如果把偶数提取出来单独组成一个数列，则有如下规律：
**f(n)=4f(n-1)+f(n-2) [n>2]**

```java
    public int sumOfEvenFibonacci(int n) {
        if(n<2) return 0;
        if(n<8) return 2;
        if(n<34) return 10;
        int result = 10;
        int temp = 0;
        int temp1 = 2;
        int temp2 = 8;
        while (temp <= n) {
            temp = temp1 + 4 * temp2;
            temp1 = temp2;
            temp2 = temp;
            result = result + temp;
        }
        result = result - temp;
        return result;
    }
```
上述代码要注意的是` while (temp <= n)`和 ` result = result - temp;`。