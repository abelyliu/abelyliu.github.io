---
title: 希尔排序
date: 2016-11-22 11:04:49
tags: Java
category: 算法
---
前面我们讨论过插入排序，插入排序比较适合于部分有序数组，而且只是比较和交换相邻的数据。当数据不是部分有序时，比如[9,8,7,6,5,4,3,2,1]时，算法的执行效率也是比较差的。我们对插入排序进行一些改进，就是我们要讨论的希尔排序。
<!--more-->

## 排序思想
首先我们回忆一下插入排序是如何排序的：
1. 将当前数放到数组的最右端
2. 和前一位比较，如果大于前一位结束
3. 如果小于前一位，则和前一位互换位置，然后再进行第二步

代码如下：
```java
public class Main {
    public static void main(String[] args) {

        int[] myarray = {9, 8, 7, 6, 5, 4, 3, 2, 1};

        for (int i = 1; i < 9; i++) {
            for (int j = i; j >= 1; j--) {
                if (less(j,j-1,myarray)) {
                    exch(j, j - 1, myarray);
                } else {
                    break;
                }
            }
        }
    }

    private static int[] exch(int i, int j, int[] array) {
        int temp = array[i];
        array[i] = array[j];
        array[j] = temp;
        return array;
    }

    private static boolean less(int i,int j, int[] array){
        return array[i] < array[j];
    }
}
```

我们可以发现，在随机数组或是不有序数组中，插入排序类似与冒泡排序。

希尔排序的思想是先将整个待排元素序列分割成若干个子序列（由相隔某个“增量”的元素组成的）分别进行直接插入排序，然后依次缩减增量再进行排序，待整个序列中的元素基本有序（增量足够小）时，再对全体元素进行一次直接插入排序。
通过分组分次进行排序，这样就从一开始的混乱到部分有序到全部有序。这种算法对部分有序数组不会产生太大的影响，因为不会太多的移动元素。

## 代码实现
希尔排序的代码实现比较简单，只要将插入排序中的1修改为h，在外层加一个h不断变小的循环。关于h的初始值和如何减小没有一个统一的定论，大家可以结合自己的项目自行选择。

```java
public static void main(String[] args) {
    int[] myarray = {9, 8, 7, 6, 5, 4, 3, 2, 1};
    int h = 1;
    while (myarray.length / 3 > h) h = h * 3 + 1;
    while (h >= 1) {
        for (int i = h; i < 9; i++) {
            for (int j = i; j >= h; j--) {
                if (less(j, j - h, myarray)) {
                    exch(j, j - h, myarray);
                } else {
                    break;
                }
            }
        }
        h = h / 3;
    }
    Arrays.stream(myarray).forEach(System.out::print);
}
```

